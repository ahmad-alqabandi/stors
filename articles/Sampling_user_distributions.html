<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Sampling from User-Defined Distributions using stors • stors</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sampling from User-Defined Distributions using stors">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">stors</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Sampling_Built_in_distributions.html">Sampling from Built-in Distributions using stors</a></li>
    <li><a class="dropdown-item" href="../articles/Sampling_user_distributions.html">Sampling from User-Defined Distributions using stors</a></li>
    <li><a class="dropdown-item" href="../articles/stors_package.html">stors package</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Sampling from User-Defined Distributions using stors</h1>
            
      

      <div class="d-none name"><code>Sampling_user_distributions.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>stors</code> package is designed to generate samples from
uni- and multimodal distributions using Rejection Sampling techniques.
While it provides optimized sampling functions for built-in
distributions, STORS also offers flexibility for users to define their
own distributions and create custom proposals for efficient
sampling.</p>
<p>In this vignette, we focus on how to use the <code>stors</code>
package to sample from user-defined distributions. We will demonstrate
how to build custom proposals for distributions not covered by the
built-in functions and how to utilize the package’s functions to sample
efficiently from these distributions.</p>
<p>To sample from user-defined distributions, you can create custom
proposals using the <code><a href="../reference/build_proposal.html">build_proposal()</a></code> function and then use
the <code><a href="../reference/build_proposal.html">build_proposal()</a></code> function to create a sampler based on
the custom proposal.</p>
</div>
<div class="section level2">
<h2 id="sampling-from-user-defined-distributions">Sampling from User-Defined Distributions<a class="anchor" aria-label="anchor" href="#sampling-from-user-defined-distributions"></a>
</h2>
<p>For distributions not covered by the built-in functions and that
satisfy the log-concavity condition, users have the flexibility to
create their own proposals using the <code><a href="../reference/build_proposal.html">build_proposal()</a></code>
function. This function is designed to handle a variety of distributions
by accepting a range of parameters tailored to the specific needs of the
distribution being sampled from.</p>
<p>The following example demonstrates the process of sampling from a
bimodal normal distribution. Let’s assume that you want to sample from a
bimodal distribution, which is a combination of two normal distributions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0.5</mn><msub><mi>w</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>0.5</mn><msub><mi>w</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f(x) = 0.5 w_1(x) + 0.5 w_2(x)</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">w_1(x) \sim N(0, 1)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>2</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>4</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">w_2(x) \sim N(4, 1)</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0.5</mn><mfrac><mn>1</mn><msqrt><mrow><mn>2</mn><mi>π</mi></mrow></msqrt></mfrac><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mfrac><msup><mi>x</mi><mn>2</mn></msup><mn>2</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>0.5</mn><mfrac><mn>1</mn><msqrt><mrow><mn>2</mn><mi>π</mi></mrow></msqrt></mfrac><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mfrac><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo>−</mo><mn>4</mn><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mn>2</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
f(x) =  0.5 \frac{1}{\sqrt{2 \pi}}  \exp\left(-\frac{x^2}{2}\right) + 0.5  \frac{1}{\sqrt{2 \pi}} \exp\left(-\frac{(x - 4)^2}{2}\right)
</annotation></semantics></math></p>
<p>To sample from the tails of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math>
using ARS, we need the log transformation of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">h(x) = \log(f(x))</annotation></semantics></math>,
and its first derivative
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>h</mi><mtext mathvariant="normal">prime</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mi>d</mi><mrow><mi>d</mi><mi>x</mi></mrow></mfrac><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">h_{\text{prime}}(x) = \frac{d}{dx} h(x)</annotation></semantics></math>.
Also, the modes of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f(x)</annotation></semantics></math>
are required to build the steps part of the proposal distribution, which
in this case are approximately at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">x = 0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">x = 4</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ahmad-alqabandi.github.io/stors/">stors</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">modes_bi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.00134865</span>, <span class="fl">3.99865</span><span class="op">)</span></span>
<span></span>
<span><span class="va">f_bi</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fl">0.5</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fl">4</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">h_bi</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu">f_bi</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">h_prime_bi</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="op">-</span><span class="fl">4</span> <span class="op">+</span> <span class="va">x</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="op">(</span><span class="op">-</span><span class="fl">4</span> <span class="op">+</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span><span class="op">)</span> <span class="op">-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span>  <span class="va">pi</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="op">-</span><span class="fl">4</span> <span class="op">+</span> <span class="va">x</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">bi_proposal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_proposal.html">build_proposal</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, upper <span class="op">=</span> <span class="cn">Inf</span>, modes <span class="op">=</span> <span class="va">modes_bi</span>, f <span class="op">=</span> <span class="va">f_bi</span>, h <span class="op">=</span> <span class="va">h_bi</span>, h_prime <span class="op">=</span> <span class="va">h_prime_bi</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bi_proposal</span><span class="op">)</span></span></code></pre></div>
<p><img src="Sampling_user_distributions_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>After building the desired proposal with
<code><a href="../reference/build_proposal.html">build_proposal()</a></code>, users can explore its properties using
the <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> function and visualize its structure using the
<code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function. This step is similar to what was done
previously with the built-in proposal and helps in understanding the
proposal’s configuration and ensuring that it aligns with the
requirements of the target distribution.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Printing the properties of the custom proposal</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bi_proposal</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Proposal Summary</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; • Total steps: 4,315</span></span>
<span><span class="co">#&gt; • Steps range: [-3.888020, 7.887194]</span></span>
<span><span class="co">#&gt; • Sampling efficiency: 99.79%</span></span>
<span></span>
<span><span class="co"># Visualizing the custom proposal</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bi_proposal</span><span class="op">)</span></span></code></pre></div>
<p><img src="Sampling_user_distributions_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>Once the proposal is configured and validated, it can be passed to
the <code><a href="../reference/build_sampler.html">build_sampler()</a></code> function. <code><a href="../reference/build_sampler.html">build_sampler()</a></code>
caches the proposal in memory, providing fast access for sampling, and
returns a sampler function for the target distribution. This sampler
function can then be used to generate samples as needed.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Creating a sampler function using the custom proposal</span></span>
<span><span class="va">bi_sampler</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_sampler.html">build_sampler</a></span><span class="op">(</span><span class="va">bi_proposal</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bi_proposal</span><span class="op">)</span></span></code></pre></div>
<p><img src="Sampling_user_distributions_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Generating samples from the target distribution</span></span>
<span><span class="va">sample</span> <span class="op">&lt;-</span> <span class="fu">bi_sampler</span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">sample</span>, main <span class="op">=</span> <span class="st">"Sample Generated From Multi-modal Distribution "</span>, xlab <span class="op">=</span> <span class="st">"Value"</span>, col <span class="op">=</span> <span class="st">"lightblue"</span>, border <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Sampling_user_distributions_files/figure-html/unnamed-chunk-4-2.png" width="700"></p>
<p>Sampling from a Truncated User-Defined Distribution To sample from a
truncated user-defined distribution, simply provide the lower and upper
truncation bounds using the (lower bound) and (upper bound) arguments.
Below, we demonstrate this process using a previously created
multi-modal distribution.</p>
<p>Example: Sampling from a Truncated Multi-Modal Distribution</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Define modes for the multi-modal distribution</span></span>
<span><span class="va">modes_bi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.00134865</span>, <span class="fl">3.99865</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Build a truncated proposal for the multi-modal distribution</span></span>
<span><span class="va">bi_trunc_proposal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_proposal.html">build_proposal</a></span><span class="op">(</span></span>
<span>  lower <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>  upper <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  modes <span class="op">=</span> <span class="va">modes_bi</span>,</span>
<span>  f <span class="op">=</span> <span class="va">f_bi</span>,</span>
<span>  h <span class="op">=</span> <span class="va">h_bi</span>,</span>
<span>  h_prime <span class="op">=</span> <span class="va">h_prime_bi</span>,</span>
<span>  steps <span class="op">=</span> <span class="fl">2040</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize the truncated proposal</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bi_trunc_proposal</span>, main <span class="op">=</span> <span class="st">"Truncated Multi-Modal Proposal (-1, 6)"</span>, xlab <span class="op">=</span> <span class="st">"Value"</span>, col <span class="op">=</span> <span class="st">"skyblue"</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_line()`: Each group consists of only one observation.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Do you need to adjust the <span style="color: #00BB00;">group</span> aesthetic?</span></span></code></pre></div>
<p><img src="Sampling_user_distributions_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Create a sampler for the truncated distribution</span></span>
<span><span class="va">bi_sampler_trunc_sampler</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/build_sampler.html">build_sampler</a></span><span class="op">(</span><span class="va">bi_trunc_proposal</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate 10^3 samples from the truncated distribution</span></span>
<span><span class="va">sample</span> <span class="op">&lt;-</span> <span class="fu">bi_sampler_trunc_sampler</span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate 10^3 samples from the truncated distribution</span></span>
<span><span class="va">sample</span> <span class="op">&lt;-</span> <span class="fu">bi_sampler_trunc_sampler</span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize the generated samples</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span></span>
<span>  <span class="va">sample</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"Histogram of Samples from Truncated Multi-Modal Distribution"</span>,</span>
<span>  xlab <span class="op">=</span> <span class="st">"Value"</span>,</span>
<span>  col <span class="op">=</span> <span class="st">"lightgreen"</span>,</span>
<span>  border <span class="op">=</span> <span class="st">"white"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="Sampling_user_distributions_files/figure-html/unnamed-chunk-5-2.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="saving-loading-and-deleting-users-proposals">Saving, Loading and Deleting Users’ Proposals<a class="anchor" aria-label="anchor" href="#saving-loading-and-deleting-users-proposals"></a>
</h2>
<p>The proposal stored in <code>bi_proposal</code> will not be preserved
across sessions. Therefore, if the user is satisfied with the sampling
results and wishes to store the proposal for future use, they should
save the proposal using the <code><a href="../reference/save_proposal.html">save_proposal()</a></code> function. This
function takes the optimized proposal and a filename chosen by the user
to save the proposal in the internal R data directory on their machine.
This is recommended if the user plans to use the proposal frequently
across sessions, to avoid re-optimizing the proposal in future
sessions.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/save_proposal.html">save_proposal</a></span><span class="op">(</span><span class="va">bi_proposal</span>, <span class="st">"bimodal_proposal"</span><span class="op">)</span></span></code></pre></div>
<p>To load and use the proposal in future sessions, the user only needs
to use the <code><a href="../reference/load_proposal.html">load_proposal()</a></code> function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">bi_proposal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_proposal.html">load_proposal</a></span><span class="op">(</span><span class="st">"bimodal_proposal"</span><span class="op">)</span></span></code></pre></div>
<p>In case the user wants to view a list of all previously stored
proposals, the <code><a href="../reference/print_proposals.html">print_proposals()</a></code> function will provide the
user with all stored proposals.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/print_proposals.html">print_proposals</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Proposals Data</span> <span style="color: #00BBBB;">──────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; Name                 | Size (KB)       | Date</span></span>
<span><span class="co">#&gt; -----------------------------------------------</span></span>
<span><span class="co">#&gt; bimodal_proposal_1   | 132.16          | 2025-03-03 17:33:52</span></span>
<span><span class="co">#&gt; bimodal_proposal_2   | 132.16          | 2025-03-03 17:33:52</span></span>
<span><span class="co">#&gt; bimodal_proposal_3   | 132.16          | 2025-03-03 17:33:52</span></span>
<span><span class="co">#&gt; bimodal_proposal     | 132.16          | 2025-03-03 17:33:52</span></span>
<span><span class="co">#&gt; bimodal              | 26.88           | 2025-03-03 17:33:16</span></span>
<span><span class="co">#&gt; normal               | 23.05           | 2025-03-03 17:33:16</span></span>
<span><span class="co">#&gt; -----------------------------------------------</span></span>
<span><span class="co">#&gt; Total Size: 578.56</span></span></code></pre></div>
<p>Be aware that the saved proposal can be quite large in size,
depending on the user’s system. Therefore, if the user wants to delete a
proposal, the <code><a href="../reference/delete_proposal.html">delete_proposal()</a></code> function can be used by
providing the proposal’s name.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="../reference/delete_proposal.html">delete_proposal</a></span><span class="op">(</span><span class="st">"bimodal_proposal"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> <span style="color: #0000BB;">"bimodal_proposal.rds"</span> proposal deleted successfully</span></span>
<span></span>
<span><span class="fu"><a href="../reference/print_proposals.html">print_proposals</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Proposals Data</span> <span style="color: #00BBBB;">──────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; Name                 | Size (KB)       | Date</span></span>
<span><span class="co">#&gt; -----------------------------------------------</span></span>
<span><span class="co">#&gt; bimodal_proposal_1   | 132.16          | 2025-03-03 17:33:52</span></span>
<span><span class="co">#&gt; bimodal_proposal_2   | 132.16          | 2025-03-03 17:33:52</span></span>
<span><span class="co">#&gt; bimodal_proposal_3   | 132.16          | 2025-03-03 17:33:52</span></span>
<span><span class="co">#&gt; bimodal              | 26.88           | 2025-03-03 17:33:16</span></span>
<span><span class="co">#&gt; normal               | 23.05           | 2025-03-03 17:33:16</span></span>
<span><span class="co">#&gt; -----------------------------------------------</span></span>
<span><span class="co">#&gt; Total Size: 446.40</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ahmad ALQabandi, Louis Aslett.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
