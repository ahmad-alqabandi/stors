<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Build Proposal — build_proposal • stors</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Build Proposal — build_proposal"><meta name="description" content="Constructs the step optimized proposal density, squeezing function, and log-linear tail proposal for a user defined probability density function."><meta property="og:description" content="Constructs the step optimized proposal density, squeezing function, and log-linear tail proposal for a user defined probability density function."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">stors</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Sampling_Built_in_distributions.html">Sampling from Built-in Distributions using stors</a></li>
    <li><a class="dropdown-item" href="../articles/Sampling_user_distributions.html">Sampling from User-Defined Distributions using stors</a></li>
    <li><a class="dropdown-item" href="../articles/stors_package.html">stors package</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Build Proposal</h1>

      <div class="d-none name"><code>build_proposal.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Constructs the step optimized proposal density, squeezing function, and log-linear tail proposal for a user defined probability density function.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">build_proposal</span><span class="op">(</span></span>
<span>  <span class="va">f</span>,</span>
<span>  <span class="va">modes</span>,</span>
<span>  lower <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>,</span>
<span>  upper <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  h <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  h_prime <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  steps <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  proposal_range <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  theta <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  target_sample_size <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-f">f<a class="anchor" aria-label="anchor" href="#arg-f"></a></dt>
<dd><p>A function which returns the (unnormalised) probability density function of the target distribution.
The first argument must be the value at which the pdf is to be evaluated.
Additional arguments may be parameters of the distribution, which should be specified by name in the <code>...</code> arguments.</p></dd>


<dt id="arg-modes">modes<a class="anchor" aria-label="anchor" href="#arg-modes"></a></dt>
<dd><p>Numeric vector of modes of the density function.</p></dd>


<dt id="arg-lower">lower<a class="anchor" aria-label="anchor" href="#arg-lower"></a></dt>
<dd><p>Numeric scalar representing the lower bound of the target density.
Default is <code>-Inf</code> for unbounded lower support.</p></dd>


<dt id="arg-upper">upper<a class="anchor" aria-label="anchor" href="#arg-upper"></a></dt>
<dd><p>Numeric scalar representing the upper bound of the target density.
Default is <code>Inf</code> for unbounded upper support.</p></dd>


<dt id="arg-h">h<a class="anchor" aria-label="anchor" href="#arg-h"></a></dt>
<dd><p>An optional function which returns the (unnormalised) log-probability density function of the target distribution.
As for <code>f</code> the first argument must be the value at which the log-pdf is to be evaluated and additional parameters may be named arguments passed to <code>...</code>.</p></dd>


<dt id="arg-h-prime">h_prime<a class="anchor" aria-label="anchor" href="#arg-h-prime"></a></dt>
<dd><p>An optional function which returns the first derivative of the (unnormalised) log-probability density function of the target distribution.
As for <code>f</code> the first argument must be the value at which the log-pdf is to be evaluated and additional parameters may be named arguments passed to <code>...</code>.</p></dd>


<dt id="arg-steps">steps<a class="anchor" aria-label="anchor" href="#arg-steps"></a></dt>
<dd><p>Optional integer scalar specifying the number of steps in the step optimised part of the proposal density and squeezing function.</p></dd>


<dt id="arg-proposal-range">proposal_range<a class="anchor" aria-label="anchor" href="#arg-proposal-range"></a></dt>
<dd><p>Optional numeric vector of length 2 specifying the lower and upper range of the steps in the step optimised part of the proposal density and squeezing function.
This range should be contained within the interval defined by <code>lower</code> and <code>upper</code>.</p></dd>


<dt id="arg-theta">theta<a class="anchor" aria-label="anchor" href="#arg-theta"></a></dt>
<dd><p>Optional numeric scalar (between 0.1 and 1) defining the pre-acceptance threshold.
This dictates when no further steps should be added in the step optimised part of the proposal density and squeezing function, based on the probability of pre-acceptance.</p></dd>


<dt id="arg-target-sample-size">target_sample_size<a class="anchor" aria-label="anchor" href="#arg-target-sample-size"></a></dt>
<dd><p>Integer scalar indicating the typical sample size that will be requested when sampling from this density using build_sampler.
The proposal optimization process bases benchmark timings on this target size in order to select a proposal best suited to the desired sample size.
Note this does <em>not</em> limit sampling to this number, it is merely a guide should the user be aware that a certain sample size will be most commonly sampled.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical scalar.
If <code>TRUE</code>, a table detailing the optimization areas and steps will be displayed during proposal optimization.
Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments to be passed to <code>f</code>, <code>h</code>, and <code>h_prime</code>, if they depend on additional parameters.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>This returns a list which is used to construct the sampler by passing to <code><a href="build_sampler.html">build_sampler</a></code> function.</p>
<p>A list containing the optimized proposal and related parameters for the specified built-in distribution:</p><dl><dt><code>data</code></dt>
<dd><p>A data frame with detailed information about the proposal steps, including:</p><dl><dt><code>x</code></dt>
<dd><p>The start point of each step on the x-axis.</p></dd>

<dt><code>s_upper</code></dt>
<dd><p>The height of each step on the y-axis.</p></dd>

<dt><code>p_a</code></dt>
<dd><p>Pre-acceptance probability for each step.</p></dd>

<dt><code>s_upper_lower</code></dt>
<dd><p>A vector used to scale the uniform random number when the sample is accepted.</p></dd>


</dl></dd>

<dt><code>areas</code></dt>
<dd><p>A numeric vector containing the areas under:</p><dl><dt><code>left_tail</code></dt>
<dd><p>The left tail bound.</p></dd>

<dt><code>steps</code></dt>
<dd><p>The middle steps.</p></dd>

<dt><code>right_tail</code></dt>
<dd><p>The right tail bound.</p></dd>


</dl></dd>

<dt><code>steps_number</code></dt>
<dd><p>An integer specifying the number of steps in the proposal.</p></dd>

<dt><code>sampling_probabilities</code></dt>
<dd><p>A numeric vector with:</p><dl><dt><code>left_tail</code></dt>
<dd><p>The probability of sampling from the left tail.</p></dd>

<dt><code>left_and_middle</code></dt>
<dd><p>The combined probability of sampling from the left tail and middle steps.</p></dd>


</dl></dd>

<dt><code>unif_scaler</code></dt>
<dd><p>A numeric scalar, the inverse probability of sampling from the steps part of the proposal (\(\frac{1}{p(lower &lt; x &lt; upper)}\)). Used for scaling uniform random values.</p></dd>

<dt><code>lt_properties</code></dt>
<dd><p>A numeric vector of 5 values required for Adaptive Rejection Sampling (ARS) in the left tail.</p></dd>

<dt><code>rt_properties</code></dt>
<dd><p>A numeric vector of 6 values required for ARS in the right tail.</p></dd>

<dt><code>alpha</code></dt>
<dd><p>A numeric scalar representing the uniform step area.</p></dd>

<dt><code>tails_method</code></dt>
<dd><p>A string, either <code>"ARS"</code> (Adaptive Rejection Sampling) or <code>"IT"</code> (Inverse Transform), indicating the sampling method for the tails.</p></dd>

<dt><code>proposal_bounds</code></dt>
<dd><p>A numeric vector specifying the left and right bounds of the target density.</p></dd>

<dt><code>cnum</code></dt>
<dd><p>An integer representing the cache number of the created proposal in memory.</p></dd>

<dt><code>symmetric</code></dt>
<dd><p>A numeric scalar indicating the symmetry point of the proposal, or <code>NULL</code> if not symmetric.</p></dd>

<dt><code>f_params</code></dt>
<dd><p>A list of parameters for the target density that the proposal is designed for.</p></dd>

<dt><code>is_symmetric</code></dt>
<dd><p>A logical value indicating whether the proposal is symmetric.</p></dd>

<dt><code>proposal_type</code></dt>
<dd><p>A string indicating the type of the generated proposal:</p><dl><dt><code>"scaled"</code></dt>
<dd><p>The proposal is "scalable" and standardized with <code>rate = 1</code>. This is used when parameter <code>rate</code> is either <code>NULL</code> or not provided. Scalable proposals are compatible with <code><a href="srexp.html">srexp</a></code>.</p></dd>

<dt><code>"custom"</code></dt>
<dd><p>The proposal is "custom" when <code>rate</code> is provided. Custom proposals are compatible with <code><a href="srexp.html">srexp_custom</a></code>.</p></dd>


</dl></dd>

<dt><code>target_function_area</code></dt>
<dd><p>A numeric scalar estimating the area of the target distribution.</p></dd>

<dt><code>dens_func</code></dt>
<dd><p>A string containing the hardcoded density function.</p></dd>

<dt><code>density_name</code></dt>
<dd><p>A string specifying the name of the target density distribution.</p></dd>

<dt><code>lock</code></dt>
<dd><p>An identifier used for saving and loading the proposal from disk.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is the starting point when a user wishes to build a custom sampler using StORS.
It is responsible for generating the step optimized proposal density, squeezing function, and log-linear tail proposal that can be utilized for this purpose.
The minimum information that must be supplied by the user is:</p><ul><li><p>The (closed) interval of support for the distribution, [<code>lower</code>, <code>upper</code>] \(\in \mathbb{R}\), which may also be half-closed on either side, or all of \(\mathbb{R}\).</p></li>
<li><p>The probability density function (pdf), which need not be normalised, <code>f</code>.</p></li>
<li><p>Any modes of the pdf, as vector <code>modes</code>.</p></li>
</ul><p>Optionally, the log-pdf and derivative of the log-pdf may be supplied.</p>
<p><strong>Arguments for pdf</strong></p>
<p>The pdf (and log-pdf and first derivative of the log-pdf) may depend on certain parameters.
If so, these can be from the second argument onward in <code>f</code>.
For instance, consider the Kumaraswamy distribution, which has pdf:
$$f(x; a,b) = a b x^{a-1}{ (1-x^a)}^{b-1},  \ \ \mbox{where} \ \ x \in (0,1)$$
This pdf has known modes.</p>
<p>Then, to implement as a custom StORS sampler, we would first define the pdf in R:</p>
<p><code>dkumaraswamy &lt;- function(x, a, b) a*b*(x^(a-1))*(1-x^a)^(b-1)</code></p>
<p>Then, to construct a StORS proposal for \(a=2\) and \(b=2\), we would call</p>
<p><code>Proposal &lt;- build_Proposal(lower = 0, upper = 1, modes = sqrt(1/3), f = dkumaraswamy, a = 2, b = 2)</code></p>
<p><strong>StORS proposal construction</strong></p>
<p>StORS defines an unnormalised piecewise constant proposal density and squeezing function, with a Proposal defining the change points.
To optimise the execution speed on modern CPUs, the unnormalised piecewise constant proposal has fixed area for each segment with one end of the segment coinciding with the user's pdf.
That is, each step of the function has width defined by \(w_i = (x_i - x_{i-1})\) and a height determined by \(h_i = \max(f(x_{i-1}), f(x_i))\), such that \(w_i h_i = \alpha \ \forall\,i\) where \(\alpha\) is constant.</p>
<p>Once the user has constructed the proposal, the sampling function can be built using <code><a href="build_sampler.html">build_sampler()</a></code>.</p>
<p><strong>Internal details</strong></p>
<p>The function <code>build_final_Proposal()</code> manages the construction of these steps and calculates values critical for the sampling process.
When the resultant Proposal is used with the <code><a href="build_sampler.html">build_sampler()</a></code> function, these values are cached,
significantly enhancing the computational efficiency and hence improving sampling speed.
During the optimization process, we aim for a certain Proposal
size based on L1-3 memory cache size. Therefore, we test the speed of Proposals of sizes \(2^m\) Kb.
To achieve this, we estimate the uniform step area
based on a certain steps number that leads to the target cache size,
\( \alpha = \frac{1}{\text{number of steps}} \).</p>
<p>The speed testing for each possible Proposal is initially based on a sample size of 1000.
However, if the user wishes to optimize the Proposal for a different sample size, they can do so
by specifying the desired sample size using the <code>target_sample_size</code> argument.</p>
<p>In case the user wants to select a specific number of steps for the proposal
and bypass the optimization process, this can be done by specifying a steps number greater than the number of modes by 2 using the <code>steps</code> argument.
If the target density is heavy-tailed,
and the user wishes to stop the Proposal building process at a certain pre-acceptance threshold, this can be achieved by setting
the acceptance probability threshold <code>theta</code> \(\theta\).
Once the steps reach this level of pre-acceptance probability,
the step construction will end \( \frac{\min(f(x_i), f(x_{i+1}))}{\max(f(x_i), f(x_{i+1}))} &lt; \theta \).
Alternatively, if the user wishes to create the steps within certain limits on the
x-axis, they can do so by specifying the proposal limits using the <code>proposal_range</code> argument.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="build_sampler.html">build_sampler</a></code>: Function to build and return a sampling function based on the provided proposal properties.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 1: Building a proposal for Standard Normal Distribution</span></span></span>
<span class="r-in"><span><span class="co"># This example demonstrates constructing a proposal for a standard normal distribution</span></span></span>
<span class="r-in"><span><span class="co"># \( f(x) \sim \mathcal{N}(0,1) \),</span></span></span>
<span class="r-in"><span><span class="co"># and shows the optimization table by setting \code{verbose} to \code{TRUE}.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define the density function, its logarithm,</span></span></span>
<span class="r-in"><span><span class="co"># and its derivative for the standard normal distribution</span></span></span>
<span class="r-in"><span><span class="va">modes_norm</span> <span class="op">=</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="va">f_norm</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span> <span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span> <span class="op">*</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">h_norm</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu">f_norm</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">h_prime_norm</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span> <span class="op">-</span><span class="va">x</span> <span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Build the proposal for the standard normal distribution</span></span></span>
<span class="r-in"><span><span class="va">norm_proposal</span> <span class="op">=</span> <span class="fu">build_proposal</span><span class="op">(</span>lower <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, upper <span class="op">=</span> <span class="cn">Inf</span>, mode <span class="op">=</span> <span class="va">modes_norm</span>,</span></span>
<span class="r-in"><span> f <span class="op">=</span> <span class="va">f_norm</span>, h <span class="op">=</span> <span class="va">h_norm</span>, h_prime <span class="op">=</span> <span class="va">h_prime_norm</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Optimization Summary</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Step:        Inf | Area: 0.008130081 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Steps      |       Area       |    Best Sim Time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -----------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---        132 ---  --- 0.007723577 ---   ---   98003.00 ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---        126 ---  --- 0.008130081 ---   ---  120564.50 ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---        120 ---  --- 0.008536585 ---   ---  113201.50 ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Step:        Inf | Area: 0.003984064 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Steps      |       Area       |    Best Sim Time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -----------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---        268 ---  --- 0.003784861 ---   ---   65256.50 ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---        254 ---  --- 0.003984064 ---   ---   57321.50 ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---        242 ---  --- 0.004183267 ---   ---   72069.50 ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Step:        Inf | Area: 0.001972387 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Steps      |       Area       |    Best Sim Time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -----------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---        538 ---  --- 0.001873767 ---   ---   38377.00 ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---        512 ---  --- 0.001972387 ---   ---   45831.00 ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---        488 ---  --- 0.002071006 ---   ---   53194.50 ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Step:        Inf | Area: 0.000981354 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Steps      |       Area       |    Best Sim Time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -----------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---       1078 ---  --- 0.000932287 ---   ---   34139.00 ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---       1024 ---  --- 0.000981354 ---   ---   28418.00 ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---        976 ---  --- 0.001030422 ---   ---   34424.00 ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Step:        Inf | Area: 0.000489476 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Steps      |       Area       |    Best Sim Time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -----------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---       2156 ---  --- 0.000465002 ---   ---   21290.00 ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---       2048 ---  --- 0.000489476 ---   ---   18705.00 ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---       1952 ---  --- 0.000513950 ---   ---   25858.00 ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Step:        Inf | Area: 0.000244439 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Steps      |       Area       |    Best Sim Time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -----------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---       4312 ---  --- 0.000232217 ---   ---   17667.50 ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---       4098 ---  --- 0.000244439 ---   ---   18479.50 ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---       3902 ---  --- 0.000256661 ---   ---   15544.00 ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Step:        Inf | Area: 0.000122145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Steps      |       Area       |    Best Sim Time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -----------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---       8626 ---  --- 0.000116038 ---   ---   17859.00 ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---       8194 ---  --- 0.000122145 ---   ---   13901.00 ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---       7804 ---  --- 0.000128252 ---   ---   18650.00 ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Step:        Inf | Area: 0.000061054 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Steps      |       Area       |    Best Sim Time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -----------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---      17248 ---  --- 0.000058001 ---   ---   25467.50 ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---      16386 ---  --- 0.000061054 ---   ---   24259.50 ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---      15606 ---  --- 0.000064106 ---   ---   20273.00 ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ────────────────────────────────────────────────────────────────────────────────</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Performance Data:</span> <span style="color: #00BBBB;">───────────────────────────────────────────────────────────</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Area       |     Time     |   Steps</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -----------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.0077235772 |   98003.00 |     132</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.0039840637 |   57321.50 |     254</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.0018737673 |   38377.00 |     538</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.0009813543 |   28418.00 |    1024</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.0004894763 |   18705.00 |    2048</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.0002566610 |   15544.00 |    3902</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.0001221449 |   13901.00 |    8194</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ────────────────────────────────────────────────────────────────────────────────</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot the generated proposal</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">norm_proposal</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="build_proposal-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: proposal for a Bimodal Distribution</span></span></span>
<span class="r-in"><span><span class="co"># This example shows how to build a proposal for sampling from a bimodal distribution,</span></span></span>
<span class="r-in"><span><span class="co">#combining two normal distributions</span></span></span>
<span class="r-in"><span><span class="co"># \( f(x) = 0.5 \cdot w_1(x) + 0.5 \cdot w_2(x) \),</span></span></span>
<span class="r-in"><span><span class="co"># where \( w_1(x) \sim \mathcal{N}(0, 1) \) and \( w_2(x) \sim \mathcal{N}(4, 1) \).</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define the bimodal density function</span></span></span>
<span class="r-in"><span><span class="va">f_bimodal</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fl">0.5</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fl">4</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">modes_bimodal</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.00134865</span>, <span class="fl">3.99865</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Build the proposal for the bimodal distribution</span></span></span>
<span class="r-in"><span><span class="va">bimodal_proposal</span> <span class="op">=</span> <span class="fu">build_proposal</span><span class="op">(</span> f <span class="op">=</span> <span class="va">f_bimodal</span>, lower <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, upper <span class="op">=</span> <span class="cn">Inf</span>, mode <span class="op">=</span> <span class="va">modes_bimodal</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Print and plot the bimodal proposal</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bimodal_proposal</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Proposal Summary</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────────</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • Total steps: 7,806</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • Steps range: [-4.044247, 8.042763]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • Sampling efficiency: 99.88%</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bimodal_proposal</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="build_proposal-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 3: Proposal with 500 Steps for Bimodal Distribution</span></span></span>
<span class="r-in"><span><span class="co"># This example demonstrates constructing a proposal with 500 steps,</span></span></span>
<span class="r-in"><span><span class="co"># for the bimodal distribution used in Example 2.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">bimodal_proposal_500</span> <span class="op">=</span> <span class="fu">build_proposal</span><span class="op">(</span>f <span class="op">=</span> <span class="va">f_bimodal</span>, lower <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, upper <span class="op">=</span> <span class="cn">Inf</span>,</span></span>
<span class="r-in"><span> mode <span class="op">=</span> <span class="va">modes_bimodal</span>, steps <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Print and plot the proposal with 500 steps</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bimodal_proposal_500</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Proposal Summary</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────────</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • Total steps: 500</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • Steps range: [-2.332842, 6.332824]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • Sampling efficiency: 98.89%</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ahmad ALQabandi, Louis Aslett.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

